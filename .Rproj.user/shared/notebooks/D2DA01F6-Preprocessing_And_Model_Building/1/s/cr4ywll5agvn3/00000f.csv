"0","# we first create a new variable called section that calculates which section number the current file belongs to based on its position in the file_list. We then add this Section column to the file_data data frame using file_data$Section <- section."
"0","# "
"0","# Inside the for loop, we use cat() to print the name of the dataset being combined (file_list[i]) and its corresponding section number (section)."
"0","# "
"0","# Finally, we print the combined_data data frame using print(combined_data)."
"0",""
"0","# Load the readxl package"
"0","library(readxl)"
"0",""
"0","# Set the directory path"
"0","dir_path <- ""G:/R_project/CIS7031/DataSet/Plan"""
"0",""
"0","# Get a list of all files in the directory"
"0","file_list <- list.files(dir_path)"
"0",""
"0","# Create an empty data frame to store the combined data"
"0","combined_data <- data.frame()"
"0",""
"0","# Loop through each file in the list"
"0","for (i in seq_along(file_list)) {"
"0","  "
"0","  # Check if the file name starts with ~$"
"0","  if (!startsWith(file_list[i], ""~$"")) {"
"0","  "
"0","    # Read the file into a data frame"
"0","    file_data <- read_excel(paste0(dir_path, ""/"", file_list[i]))"
"0","    "
"0","    section <- ceiling(i / 12)"
"0","  "
"0","    # Add a new column called ""Section"" with a value based on the file number"
"0","    section <- ifelse(i <= 12, 1, ifelse(i <= 24, 2, ifelse(i <= 36, 3, 4)))"
"0","    file_data$Section <- section"
"0","  "
"0","    # Print the name of the dataset being combined"
"0","    cat(""Combining"", file_list[i], ""into section"", section, ""\n"")"
"0","  "
"0","    # Combine the data with the existing data frame"
"0","    combined_data <- rbind(combined_data, file_data)"
"0","    "
"0","  } else {"
"0","    "
"0","    # Print a message indicating that the file was skipped"
"0","    cat(""Skipping temporary file:"", file_list[i], ""\n"")"
"0","    "
"0","  }"
"0","}"
"1","Skipping temporary file:"
"1"," "
"1","~$LC Sec 1 - 01.02 - 01.12.xlsx"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 01.02 - 01.12.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 01.15 - 01.26.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 01.29 - 02.09.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 02.12 - 02.24.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 02.26 - 03.10.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 03.12 - 03.24.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 03.26 - 03.30.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 04.02 - 04.27.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 05.01 - 05.12.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 05.14 - 05.25.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 1 - 05.30 - 06.13.xlsx"
"1"," "
"1","into section"
"1"," "
"1","1"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 01.02 - 01.12.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 01.15 - 01.26.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 01.29 - 02.09.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 02.12 - 02.24.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 02.26 - 03.10.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 03.12 - 03.24.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 03.26 - 03.30.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 04.02 - 04.27.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 05.01 - 05.12.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 05.14 - 05.25.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 05.30 - 06.13.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 2 - 06.18 - 06.29.xlsx"
"1"," "
"1","into section"
"1"," "
"1","2"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 01.02 - 01.12.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 01.15 - 01.26.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 01.29 - 02.09.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 02.12 - 02.24.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 02.26 - 03.10.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 03.12 - 03.24.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 03.26 - 03.30.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 04.02 - 04.27.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 05.01 - 05.12.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 05.14 - 05.25.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 05.30 - 06.13.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 3 - 06.18 - 06.29.xlsx"
"1"," "
"1","into section"
"1"," "
"1","3"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 01.02 - 01.12.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 01.15 - 01.26.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 01.29 - 02.09.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 02.12 - 02.24.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 02.26 - 03.10.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 03.12 - 03.24.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 03.26 - 03.30.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 04.02 - 04.27.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 05.01 - 05.12.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 05.14 - 05.25.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 05.30 - 06.13.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"1","Combining"
"1"," "
"1","LC Sec 4 - 06.18 - 06.29.xlsx"
"1"," "
"1","into section"
"1"," "
"1","4"
"1"," "
"1","
"
"0","# Print the combined data"
"0","print(combined_data)"
